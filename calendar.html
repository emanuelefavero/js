<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Date Picker</title>

    <style>
      .date-picker {
        position: relative;
        display: inline-block;
      }

      .calendar {
        position: absolute;
        top: 100%;
        left: 0;
        background-color: #fff;
        border: 1px solid #ddd;
        padding: 10px;
        z-index: 1;
      }

      .calendar table {
        width: 100%;
        border-collapse: collapse;
      }

      .calendar th,
      .calendar td {
        text-align: center;
        padding: 5px;
        border: 1px solid #ddd;
      }

      .calendar th {
        background-color: #f0f0f0;
      }

      .date-input {
        width: 200px;
        padding: 10px;
        border: 1px solid #ddd;
      }
    </style>
  </head>
  <body>
    <div id="datePicker" class="date-picker">
      <input
        type="text"
        id="dateInput"
        class="date-input"
        placeholder="Select a date"
        readonly
      />
      <div id="calendar" class="calendar" style="display: none">
        <!-- Calendar will be generated by JavaScript -->
      </div>
    </div>

    <!-- TODO refactor calendar -->

    <script>
      document.addEventListener('DOMContentLoaded', function () {
        const dateInput = document.getElementById('dateInput')
        const calendar = document.getElementById('calendar')

        dateInput.addEventListener('click', function () {
          calendar.style.display = 'block'
          generateCalendar(new Date())
        })

        function generateCalendar(date) {
          const monthDays = new Date(
            date.getFullYear(),
            date.getMonth() + 1,
            0
          ).getDate()
          const startDay = new Date(
            date.getFullYear(),
            date.getMonth(),
            1
          ).getDay()

          let calendarHTML =
            '<table><tr><th>Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fr</th><th>Sa</th></tr><tr>'
          for (let i = 0; i < startDay; i++) {
            calendarHTML += '<td></td>'
          }

          for (let day = 1; day <= monthDays; day++) {
            if ((day + startDay - 1) % 7 === 0) {
              calendarHTML += '</tr><tr>'
            }
            calendarHTML += `<td class="calendar-day">${day}</td>`
          }

          calendarHTML += '</tr></table>'
          calendar.innerHTML = calendarHTML

          document.querySelectorAll('.calendar-day').forEach((day) => {
            day.addEventListener('click', function () {
              dateInput.value = `${date.getFullYear()}-${String(
                date.getMonth() + 1
              ).padStart(2, '0')}-${String(day.textContent).padStart(2, '0')}`
              calendar.style.display = 'none'
            })
          })
        }
      })
    </script>
  </body>
</html>
