<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Date Picker</title>

    <style>
      :root {
        --border-radius: 0.5rem;
      }

      body {
        font-family: -apple-system, system-ui, BlinkMacSystemFont, 'Inter',
          'SF Pro', 'San Francisco Pro', 'Helvetica Neue', Helvetica, 'Segoe UI',
          Roboto, Oxygen, Ubuntu, Cantarell, 'Open Sans', sans-serif;
      }

      .date-picker {
        position: relative;
        display: inline-block;

        & input {
          margin-bottom: 1rem;
        }
      }

      .calendar {
        position: absolute;
        top: 100%;
        left: 0;
        background-color: #f5f5f4;
        border: 1px solid rgba(0, 0, 0, 0.1);
        border-radius: 1rem;
        padding: 10px;
        user-select: none;
        z-index: 1;

        & table {
          width: 100%;
          border-collapse: separate;
          border-spacing: 0;
        }

        & th,
        & td {
          text-align: center;
          padding: 5px;
          border: 1px solid rgba(0, 0, 0, 0.1);
        }

        & th {
          background-color: #f0f0f0;
        }

        & td {
          cursor: pointer;
          background-color: #fff;
          transition: background-color 0.3s;

          &.selected {
            background-color: #a855f7;
            color: #fff;
          }
        }

        & td:hover {
          background-color: #a855f7;
          color: #fff;
        }

        & td:active {
          background-color: #7e22ce;
        }

        /* --- */
        /* TABLE BORDER RADIUS */
        /* Top left cell */
        & th:first-child {
          border-top-left-radius: var(--border-radius);
        }

        /* Top right cell */
        & th:last-child {
          border-top-right-radius: var(--border-radius);
        }

        /* Bottom left cell */
        & tr:last-child & td:first-child {
          border-bottom-left-radius: var(--border-radius);
        }

        /* Bottom right cell */
        & tr:last-child {
          border-bottom-right-radius: var(--border-radius);
        }
        /* --- */
      }

      .date-input {
        width: 200px;
        padding: 10px;
        color: #a855f7;
        font-weight: 600;
        border: 1px solid #ddd;
        border-radius: var(--border-radius);

        &:focus {
          outline: none;
          border-color: #a855f7;
        }
      }
    </style>
  </head>
  <body>
    <!-- HTML -->
    <div id="datePicker" class="date-picker">
      <input
        type="text"
        id="dateInput"
        class="date-input"
        placeholder="Select a date..."
        readonly
      />
      <div id="calendar" class="calendar" style="display: none">
        <!-- Calendar will be generated by JavaScript -->
      </div>
    </div>

    <!-- JS -->
    <script>
      const dateInput = document.getElementById('dateInput')
      const calendar = document.getElementById('calendar')

      // Create a variable called selectedDay and assign the current day number to it
      let selectedDay = new Date().getDate()

      // Show the calendar when the input is clicked
      dateInput.addEventListener('click', function () {
        calendar.style.display = 'block'
        generateCalendar(new Date())
      })

      // TODO test the function by practicing with the date object

      function generateCalendar(date) {
        // Get the number of days in the month by creating a new date object with the next month's first day and subtracting 1 (this will return the last day of the current month which is the number of days in the month)
        const monthDays = new Date(
          date.getFullYear(),
          date.getMonth() + 1,
          0
        ).getDate()

        // Get the day of the week the first day of the month falls on. This will also be used to determine the number of empty cells to add to the beginning of the calendar. getDay() will return a number between 0 and 6, where 0 is Sunday and 6 is Saturday.
        const startDay = new Date(
          date.getFullYear(),
          date.getMonth(),
          1
        ).getDay()

        // Create the calendar HTML
        let calendarHTML =
          '<table><tr><th>Su</th><th>Mo</th><th>Tu</th><th>We</th><th>Th</th><th>Fr</th><th>Sa</th></tr><tr>'

        // Add empty cells to the beginning of the calendar
        for (let i = 0; i < startDay; i++) {
          calendarHTML += '<td></td>'
        }

        // Add the days of the month to the calendar
        for (let day = 1; day <= monthDays; day++) {
          // Start a new row when the day is Sunday
          if ((day + startDay - 1) % 7 === 0) {
            calendarHTML += '</tr><tr>'
          }

          // Highlight the selected day and add each day to the calendar
          if (day === selectedDay) {
            calendarHTML += `<td class="calendar-day selected">${day}</td>`
          } else {
            calendarHTML += `<td class="calendar-day">${day}</td>`
          }
        }

        // Close the table and set the calendar HTML
        calendarHTML += '</tr></table>'
        calendar.innerHTML = calendarHTML

        // Add an event listener to each day
        document.querySelectorAll('.calendar-day').forEach((day) => {
          day.addEventListener('click', function () {
            // Set the date input value as the selected date
            dateInput.value = `${date.getFullYear()}-${String(
              date.getMonth() + 1
            ).padStart(2, '0')}-${String(day.textContent).padStart(2, '0')}`

            // TIP: padStart will add leading zeros to the month and day if they are less than 10

            // Update the selected day
            selectedDay = parseInt(day.textContent)

            // Hide the calendar
            calendar.style.display = 'none'
          })
        })
      }

      // Hide the calendar when the user clicks outside of it
      document.addEventListener('click', function (event) {
        // Check if the click is outside of both the calendar and the date input
        if (!calendar.contains(event.target) && event.target !== dateInput) {
          // Hide the calendar if the click is outside
          calendar.style.display = 'none'
        }
      })
    </script>
  </body>
</html>
